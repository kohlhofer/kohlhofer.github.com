(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{527:(e,t,r)=>{"use strict";r.d(t,{default:()=>d});var s=r(5155),a=r(2115),n=function(e){return e.WATER="water",e.GRASSLAND="grassland",e.FOREST="forest",e.DESERT="desert",e.MOUNTAIN="mountain",e.HILLS="hills",e.SWAMP="swamp",e.BRUSH="brush",e}({});function l(e){return function(){let t=e+=0x6d2b79f5;return t=Math.imul(t^t>>>15,1|t),(((t^=t+Math.imul(t^t>>>7,61|t))^t>>>14)>>>0)/0x100000000}}function o(e,t){return(e.q%2==0?[[1,0],[1,-1],[0,-1],[-1,0],[0,1],[1,1]]:[[1,0],[0,-1],[-1,-1],[-1,0],[-1,1],[0,1]]).map(r=>{let[s,a]=r;return t["".concat(e.q+s,",").concat(e.r+a)]}).filter(e=>e)}function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,r=parseInt((e=e.replace("#","")).substring(0,2),16),s=parseInt(e.substring(2,4),16),a=parseInt(e.substring(4,6),16);return r=Math.floor(r*t),s=Math.floor(s*t),a=Math.floor(a*t),"#".concat(r.toString(16).padStart(2,"0")).concat(s.toString(16).padStart(2,"0")).concat(a.toString(16).padStart(2,"0"))}let h=e=>{switch(e){case"water":return"#4A90E2";case"grassland":case"hills":return"#9CAF7F";case"forest":return"#6B8E6B";case"desert":return"#D4B483";case"mountain":return"#8B8B8B";case"swamp":return"#B2A76B";case"brush":return"#8B9E6B";default:return"#000000"}};function c(e){let t,r=h(e);switch(e){case"desert":t="#7a5a2b";break;case"forest":case"mountain":t=i(r,.6);break;case"grassland":case"hills":case"swamp":case"brush":t=i(r,.65);break;default:t=i(r,.7)}let s=parseInt(t.replace("#",""),16);return(s>0xcccccc||s<2236962)&&(t="#333"),t}function d(){let[e,t]=(0,a.useState)([]),[r,i]=(0,a.useState)({}),[d,f]=(0,a.useState)(null),[x,u]=(0,a.useState)(20),[m,g]=(0,a.useState)(15),[k]=(0,a.useState)(20),[j,w]=(0,a.useState)("12345"),[p,y]=(0,a.useState)([]),M=(0,a.useCallback)(()=>{let e=window.innerWidth,t=window.innerHeight-120,r=Math.floor((e-100)/(1.5*k)),s=Math.floor((t-100)/(k*Math.sqrt(3)*.7)),a=e/t,n=r,l=s;return a>1.5?l=Math.min(s,Math.round((n=r)/a)):a<.8&&(n=Math.min(r,Math.round((l=s)*a))),n=Math.max(n,10),l=Math.max(l,8),{width:n=Math.min(n,50),height:l=Math.min(l,35)}},[k]),b=(0,a.useCallback)((e,t)=>({x:1.5*k*e,y:k*Math.sqrt(3)*.7*(t+e%2*.5)}),[k]),v=(0,a.useCallback)(e=>{let t=[];for(let r=0;r<6;r++){let s=2*Math.PI/6*r,a=e.x+k*Math.cos(s),n=e.y+.7*k*Math.sin(s);t.push("".concat(a,",").concat(n))}return t.join(" ")},[k]),L=(0,a.useCallback)(()=>{let e=0;for(let t=0;t<j.length;t++)e=31*e+j.charCodeAt(t)|0;let s=l(e),a=[],n=[];for(let e=0;e<x;e++)for(let t=0;t<m;t++){n.push([e,t]);let s=0===e||0===t||e===x-1||t===m-1,l={id:"".concat(e,",").concat(t),q:e,r:t,terrain:s?"water":null};r[l.id]=l,a.push(l)}let h=[],c=Math.floor(x/2),d=Math.floor(m/2),f=Math.floor(x*m*.4+s()*(x*m)*.1),u=[r["".concat(c,",").concat(d)]];for(r["".concat(c,",").concat(d)].terrain="grassland",h.push(r["".concat(c,",").concat(d)]);h.length<f&&u.length>0;){let e=u[Math.floor(s()*u.length)],t=o(e,r).filter(e=>"water"!==e.terrain&&!h.includes(e));if(0===t.length){u=u.filter(t=>t!==e);continue}let a=t[Math.floor(s()*t.length)];a.terrain="grassland",h.push(a),u.push(a),.3>s()&&(u=u.filter(t=>t!==e))}for(let e of a)e.terrain||(e.terrain="water");let g=["forest","desert","mountain","hills","swamp","brush"];for(let e=g.length-1;e>0;e--){let t=Math.floor(s()*(e+1));[g[e],g[t]]=[g[t],g[e]]}let w={forest:{count:Math.max(2,Math.floor(h.length/40)),size:Math.max(8,Math.floor(h.length/12))},desert:{count:Math.max(1,Math.floor(h.length/80)),size:Math.max(4,Math.floor(h.length/20))},mountain:{count:Math.max(1,Math.floor(h.length/80)),size:Math.max(3,Math.floor(h.length/30))},hills:{count:Math.max(1,Math.floor(h.length/60)),size:Math.max(4,Math.floor(h.length/20))},swamp:{count:Math.max(1,Math.floor(h.length/100)),size:Math.max(3,Math.floor(h.length/25))},brush:{count:Math.max(1,Math.floor(h.length/80)),size:Math.max(4,Math.floor(h.length/20))},water:{count:0,size:0},grassland:{count:Math.max(2,Math.floor(h.length/50)),size:Math.max(6,Math.floor(h.length/15))}};for(let e of g){let{count:t,size:a}=w[e];for(let n=0;n<t;n++){let t,n=0;do t=h[Math.floor(s()*h.length)],n++;while("grassland"!==t.terrain&&n<20);if(!t||"grassland"!==t.terrain)continue;if("swamp"===e){let e=h.filter(e=>"grassland"===e.terrain&&o(e,r).some(e=>"water"===e.terrain||"forest"===e.terrain));e.length>0&&(t=e[Math.floor(s()*e.length)])}else if("brush"===e){let e=h.filter(e=>("grassland"===e.terrain||"hills"===e.terrain)&&o(e,r).some(e=>"desert"===e.terrain)&&!o(e,r).some(e=>"water"===e.terrain));e.length>0&&(t=e[Math.floor(s()*e.length)])}t.terrain=e;let l=[t],i="swamp"===e?Math.floor(.7*a):a;for(let t=0;t<i&&0!==l.length;t++){let t=l[Math.floor(s()*l.length)],a=o(t,r).filter(e=>"grassland"===e.terrain);if("swamp"===e&&(a=a.concat(o(t,r).filter(e=>"forest"===e.terrain)),.4>s()&&(l=l.filter(e=>e!==t))),"brush"===e&&(a=a.concat(o(t,r).filter(e=>"hills"===e.terrain))),0===a.length)continue;let n=a[Math.floor(s()*a.length)];n.terrain=e,l.push(n),.3>s()&&(l=l.filter(e=>e!==t))}}}for(let e of h)null===e.terrain&&(e.terrain="grassland");for(let e of h)"mountain"!==e.terrain&&o(e,r).filter(e=>"mountain"===e.terrain).length>0&&"hills"!==e.terrain&&.5>s()&&(e.terrain="hills");for(let e of h)"desert"!==e.terrain&&("grassland"===e.terrain||"hills"===e.terrain)&&o(e,r).filter(e=>"desert"===e.terrain).length>0&&.2>s()&&(e.terrain="desert");function p(e){return o(e,r).some(e=>"water"===e.terrain)}function M(e){switch(e){case"mountain":return 5;case"hills":return 4;case"forest":return 3;case"grassland":return 2;case"desert":return 1;default:return 0}}function v(e,t){return(Math.abs(e.q-t.q)+Math.abs(e.q+e.r-t.q-t.r)+Math.abs(e.r-t.r))/2}function L(e,t,r){let s=o(e,t),a=B(r+"-"+e.id);return s.slice().sort((e,t)=>a()-.5)}let W=h.filter(e=>"mountain"===e.terrain&&!p(e)&&o(e,r).some(e=>"mountain"!==e.terrain)),N=Math.max(1,Math.floor(h.length/100)),q=0,S=0;for(;q<N&&S<30;){S++;let e=W.slice().sort((e,t)=>e.id.localeCompare(t.id)),t=e[q%e.length];if(!t)break;let s=function(e,t){let s=[[0,0,e,[e]]],a=new Set,n=0;for(;s.length&&n++<2e3;){s.sort((e,t)=>e[0]-t[0]||e[1]-t[1]);let[n,l,o,i]=s.shift();if(t(o))return i;for(let t of(a.add(o.id),L(o,r,j).filter(e=>"water"!==e.terrain&&!e.river&&!a.has(e.id)))){let r=l+(1+Math.max(0,M(t.terrain)-M(o.terrain))),a=v(t,e);s.push([r+a,r,t,[...i,t]])}}return null}(t,p);if(s&&s.length>3){if(function(e){for(let t of e){let s=o(t,r);for(let t of s)if(t.river&&!e.includes(t)&&s.filter(e=>"water"!==e.terrain&&!e.river).length<=1)return!0}return!1}(s))continue;for(let e of s)e.river=!0;if(function(){let e=a.filter(e=>"water"!==e.terrain);if(0===e.length)return!0;let t=new Set,s=[e[0]];for(t.add(e[0].id);s.length;)for(let e of o(s.shift(),r))"water"===e.terrain||t.has(e.id)||(t.add(e.id),s.push(e));return t.size===e.length}())q++;else for(let e of s)e.river=!1}}for(let e of a)e.river&&(e.terrain="water",e.river=!0);function C(t){if("water"===t.terrain||"mountain"===t.terrain||"swamp"===t.terrain)return -1e3;let s=0;"grassland"===t.terrain&&(s+=5),"hills"===t.terrain&&(s+=3),"forest"===t.terrain&&(s+=1),"desert"===t.terrain&&(s-=2);let a=o(t,r);a.some(e=>e.river)&&(s+=4),a.some(e=>"water"===e.terrain)&&(s+=3);let n=Math.floor(x/2),i=Math.floor(m/2);return(s+=4*l(e+1e3*t.q+17*t.r)())+3*(Math.sqrt((t.q-n)**2+(t.r-i)**2)/(Math.sqrt(x*x+m*m)/2))}let E=a.filter(e=>"water"!==e.terrain).length,z=Math.min(1,Math.sqrt(x*m)/25),A=Math.min(2,Math.max(1,Math.floor(E/2e3*z))),Q=Math.min(3,Math.max(1,Math.floor(E/300*z))),F=Math.min(4,Math.max(2,Math.floor(E/120*z)));console.log("Map size: ".concat(x,"x").concat(m,", Land tiles: ").concat(E,", Size factor: ").concat(z.toFixed(2))),console.log("Settlements: ".concat(A," cities, ").concat(Q," towns, ").concat(F," villages"));let I=new Set;function O(e,t,r){let s=a.filter(e=>"water"!==e.terrain&&!I.has(e.id));s=s.map(e=>({t:e,score:C(e)})).sort((e,t)=>t.score-e.score).map(e=>e.t);let n=x/3,l=m/3,o=0,i=t;if("city"!==e){let o=new Map;for(let t=0;t<3;t++)for(let i=0;i<3;i++){let h="".concat(t,",").concat(i),c=s.filter(e=>{let r=Math.floor(e.q/n),s=Math.floor(e.r/l);return r===t&&s===i});if(c.length>0){let t=c.map(e=>({t:e,score:C(e)})).sort((e,t)=>t.score-e.score)[0].t,s=!1;for(let e of a)if(e.settlement&&Math.abs(e.q-t.q)+Math.abs(e.r-t.r)<r){s=!0;break}s||(t.settlement=e,I.add(t.id),o.set(h,!0))}}i=t-Array.from(o.values()).filter(e=>e).length}let h=0,c=0;for(;h<i&&c<s.length;){let t=s[c];if(I.has(t.id)){c++;continue}let n=!0;for(let e of a)if(e.settlement&&Math.abs(e.q-t.q)+Math.abs(e.r-t.r)<r){n=!1;break}n&&(t.settlement=e,I.add(t.id),h++),c++}}O("city",A,5),O("town",Q,3),O("village",F,2);let Z=new Set,Y=[],X=a.filter(e=>e.settlement),P=[...X.filter(e=>"city"===e.settlement),...X.filter(e=>"town"===e.settlement)];if(P.length>1){let e=[P[0]],t=P.slice(1);for(;t.length>0;){let s=null,a=1/0,n=null;for(let l of e)for(let e of t){let t=function(e,t){let s=new Map,a=new Map;a.set(e.id,[0,0,e,[e]]);let n=0;for(;a.size>0&&n++<2e3;){let e=1/0,n="";for(let[t,[r]]of a)r<e&&(e=r,n=t);let[o,i,h,c]=a.get(n);if(a.delete(n),h.id===t.id)return c;for(let e of(s.set(h.id,i),L(h,r,j).filter(e=>{let t=s.get(e.id);if(void 0!==t&&t<=i)return!1;let r=a.get(e.id);return!r||!(r[1]<=i)}))){var l;let r=i+(null!=(l=T[e.terrain])?l:1e3),s=r+v(e,t),n=a.get(e.id);(!n||r<n[1])&&a.set(e.id,[s,r,e,[...c,e]])}}return null}(l,e);if(!t)continue;let o=0;for(let e=0;e<t.length-1;e++){var D;o+=null!=(D=T[t[e+1].terrain])?D:1e3}o<a&&(a=o,s=e,n=t)}if(n&&s){!function(e){for(let t=0;t<e.length-1;t++){let r=e[t].id,s=e[t+1].id,a=r<s?"".concat(r,"|").concat(s):"".concat(s,"|").concat(r);Z.add(a)}let t=[];for(let r=0;r<e.length-1;r++){let s=e[r],a=e[r+1],n=b(s.q,s.r),l=b(a.q,a.r);0===r&&t.push(n);let o=B(j+"-"+s.id+"-"+a.id),i=5+Math.floor(2*o());for(let e=1;e<=i;e++){let r=e/(i+1),s=n.x*(1-r)+l.x*r,a=n.y*(1-r)+l.y*r,h=l.x-n.x,c=l.y-n.y,d=Math.sqrt(h*h+c*c)||1,f=-c/d,x=h/d,u=Math.sin(Math.PI*r),m=(.12+.22*o())*k*u;s+=f*m*(o()-.5)*2,a+=x*m*(o()-.5)*2,t.push({x:s,y:a})}t.push(l)}Y.push(t)}(n),e.push(s);let r=t.findIndex(e=>e.id===s.id);-1!==r&&t.splice(r,1)}else break}}y(Y),t(a),i(r)},[x,m,j,k]),W=(()=>{let e=2*k,t=Math.sqrt(3)*k,r=-k+e/2,s=1.5*k*(x-1)+k-e/2,a=1/0,n=-1/0;for(let e=0;e<x;e++)for(let t=0;t<m;t++){let{x:r,y:s}=b(e,t);a=Math.min(a,s),n=Math.max(n,s)}return{minX:r,maxX:s,minY:a=a-t/2+t/2,maxY:n=n+t/2-t/2}})(),B=e=>{let t=0;for(let r=0;r<e.length;r++)t=31*t+e.charCodeAt(r)|0;return l(t)},N={};function q(t,r){let s=e.filter(e=>e.terrain===t),a=new Set,n=[];for(let e of s){if(a.has(e.id))continue;let r=[],s=[e];for(a.add(e.id);s.length;){let e=s.shift();for(let n of(r.push(e),o(e,N)))n.terrain!==t||a.has(n.id)||(a.add(n.id),s.push(n))}n.push(r)}let l=[];return n.forEach((e,t)=>{let s=1/0,a=-1/0,n=1/0,o=-1/0;for(let t of e){let{x:e,y:r}=b(t.q,t.r);s=Math.min(s,e),a=Math.max(a,e),n=Math.min(n,r),o=Math.max(o,r)}let i=.85*k,h=s-.5*i,c=a+.5*i,d=n-.5*i,f=o+.5*i,x=0;for(let s=h;s<=c;s+=i){let a=Math.round((s-h)/i);for(let n=d;n<=f;n+=.9*i){let o=Math.round((n-d)/(.9*i)),h=B("tree-".concat(t,"-").concat(a,"-").concat(o)),c=(h()-.5)*k*.35,f=(h()-.5)*k*.35,u=s+c,m=n+f+(x%2==0?0:.45*i),g=null,j=1/0;for(let t of e){let{x:e,y:r}=b(t.q,t.r),s=(u-e)**2+(m-r)**2;s<j&&(g=t,j=s)}if(g&&j<(.95*k)**2){let[e,s]=r,n=k*(e+h()*(s-e));l.push({x:u,y:m,size:n,clusterIdx:t,gridX:a,gridY:o})}}x++}}),l}e.forEach(e=>{N["".concat(e.q,",").concat(e.r)]=e});let S=["The Island of {name}","The Kingdom of {name}","The Dark Island of {name}","The Shores of {name}","The Realm of {name}","The Lost Isle of {name}","The Wilds of {name}","The Peninsula of {name}","The Highlands of {name}","The Domain of {name}"],C=["Aeloria","Brightholm","Cindervale","Duskmoor","Eldermist","Frostmere","Gloamwood","Hallowmere","Ironreach","Jadewind","Kingsfall","Lornspire","Mistvale","Nightriver","Oakenshade","Pyrecoast","Quillhaven","Ravenrock","Stormhold","Thornwild","Umberdeep","Vastwood","Wyrmrest","Zephyris"],E=B(j+"-name"),z=S[Math.floor(E()*S.length)],A=C[Math.floor(E()*C.length)],Q=z.replace("{name}",A),T={water:1e3,mountain:200,swamp:120,forest:12,hills:5,grassland:3,desert:7,brush:8};(0,a.useEffect)(()=>{let e=()=>{let{width:e,height:t}=M();u(e),g(t)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[M]),(0,a.useEffect)(()=>{x>0&&m>0&&L()},[x,m,j,L]);let F=e=>{f(e.currentTarget.getAttribute("data-id"))},I=()=>{f(null)};return(0,s.jsxs)("div",{className:"min-h-screen flex flex-col",style:{backgroundColor:"#4A90E2"},children:[(0,s.jsx)("div",{className:"w-full py-8 text-center",children:(0,s.jsx)("h1",{className:"text-2xl font-serif text-[#223344] opacity-80 italic tracking-wide",children:Q})}),(0,s.jsx)("div",{className:"fixed top-4 left-4 z-20",children:(0,s.jsx)("button",{onClick:()=>{w(Math.floor(1e9*Math.random()).toString(36))},className:"w-10 h-10 flex items-center justify-center bg-[#4A90E2] hover:bg-[#3573b5] transition-colors border-2 border-[#3573b5] rounded-full shadow",title:"Generate New Map","aria-label":"Generate New Map",children:(0,s.jsx)("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 4v5h.582M20 20v-5h-.581M19.418 9A7.978 7.978 0 0012 4a8 8 0 00-7.418 5M4.582 15A7.978 7.978 0 0012 20a8 8 0 007.418-5"})})})}),(0,s.jsx)("div",{className:"flex justify-center w-full",children:(0,s.jsx)("div",{className:"relative",style:{width:"".concat(W.maxX-W.minX,"px"),height:"".concat(W.maxY-W.minY,"px")},children:(0,s.jsxs)("svg",{className:"w-full h-full block",style:{display:"block"},viewBox:"".concat(W.minX," ").concat(W.minY," ").concat(W.maxX-W.minX," ").concat(W.maxY-W.minY),children:[(0,s.jsx)("defs",{children:(()=>{let e=W.minX,t=W.minY,r=W.maxX-W.minX,a=W.maxY-W.minY;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("clipPath",{id:"map-clip",children:(0,s.jsx)("rect",{x:e,y:t,width:r,height:a})}),(0,s.jsxs)("symbol",{id:"shore-wave-1",viewBox:"-8 -4 16 8",stroke:"#dbeafe",strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,s.jsx)("path",{d:"M-6,-1 Q-5,0 -4,-1"}),(0,s.jsx)("path",{d:"M-2,1 Q-1,2 0,1"}),(0,s.jsx)("path",{d:"M3,0 Q4,1 5,0"})]}),(0,s.jsxs)("symbol",{id:"shore-wave-2",viewBox:"-8 -4 16 8",stroke:"#dbeafe",strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,s.jsx)("path",{d:"M-5,0 Q-4,1 -3,0"}),(0,s.jsx)("path",{d:"M0,-1 Q1,0 2,-1"})]}),(0,s.jsxs)("symbol",{id:"shore-wave-3",viewBox:"-8 -4 16 8",stroke:"#dbeafe",strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,s.jsx)("path",{d:"M-6,0 Q-5,1 -4,0"}),(0,s.jsx)("path",{d:"M-1,1 Q0,2 1,1"}),(0,s.jsx)("path",{d:"M4,-1 Q5,0 6,-1"})]}),(0,s.jsxs)("symbol",{id:"shore-wave-4",viewBox:"-8 -4 16 8",stroke:"#dbeafe",strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,s.jsx)("path",{d:"M-7,-1 Q-6,0 -5,-1"}),(0,s.jsx)("path",{d:"M-2,0 Q-1,1 0,0"})]}),(0,s.jsxs)("symbol",{id:"forest-evergreen",viewBox:"-10 -16 20 32",stroke:"currentColor",strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,s.jsx)("line",{x1:"0",y1:"12",x2:"0",y2:"-12"}),(0,s.jsx)("polyline",{points:"0,-12 -4,0 4,0 0,-12"})]}),(0,s.jsxs)("symbol",{id:"forest-broadleaf",viewBox:"-10 -14 20 28",stroke:"currentColor",strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,s.jsx)("line",{x1:"0",y1:"10",x2:"0",y2:"2"}),(0,s.jsx)("circle",{cx:"0",cy:"-2",r:"6"})]}),(0,s.jsxs)("symbol",{id:"mountain-peak",viewBox:"-12 -12 24 24",stroke:"currentColor",strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,s.jsx)("polyline",{points:"-10,10 0,-10 6,0 10,6"}),(0,s.jsx)("polyline",{points:"0,-10 2,-2 6,0"})]}),(0,s.jsx)("symbol",{id:"hill-arch",viewBox:"-12 -8 24 16",stroke:"currentColor",strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",children:(0,s.jsx)("path",{d:"M-8,6 Q0,-4 8,6"})}),(0,s.jsxs)("symbol",{id:"grass-tuft",viewBox:"-10 -10 20 20",stroke:"currentColor",strokeWidth:"1",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,s.jsx)("path",{d:"M-2,-6 Q-3,-2 0,0"}),(0,s.jsx)("path",{d:"M0,-6 Q0,-2 0,0"}),(0,s.jsx)("path",{d:"M2,-6 Q3,-2 0,0"})]}),(0,s.jsx)("symbol",{id:"desert-rock1",viewBox:"-10 -6 20 12",stroke:"currentColor",strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",children:(0,s.jsx)("ellipse",{cx:"0",cy:"2",rx:"5",ry:"3"})}),(0,s.jsxs)("symbol",{id:"desert-rock2",viewBox:"-10 -6 20 12",stroke:"currentColor",strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,s.jsx)("ellipse",{cx:"-2",cy:"2",rx:"3",ry:"2"}),(0,s.jsx)("ellipse",{cx:"3",cy:"3",rx:"2",ry:"1.2"})]}),(0,s.jsxs)("symbol",{id:"desert-rock3",viewBox:"-10 -6 20 12",stroke:"currentColor",strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,s.jsx)("ellipse",{cx:"0",cy:"3",rx:"2.5",ry:"1.2"}),(0,s.jsx)("ellipse",{cx:"-3",cy:"1",rx:"1.2",ry:"0.7"}),(0,s.jsx)("ellipse",{cx:"3",cy:"1",rx:"1.2",ry:"0.7"})]}),(0,s.jsxs)("symbol",{id:"swamp-marsh",viewBox:"-10 -10 20 20",stroke:"currentColor",strokeWidth:"1",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,s.jsx)("line",{x1:"-3",y1:"4",x2:"-1",y2:"-4"}),(0,s.jsx)("line",{x1:"0",y1:"4",x2:"0",y2:"-2"}),(0,s.jsx)("line",{x1:"3",y1:"4",x2:"1",y2:"-3"}),(0,s.jsx)("ellipse",{cx:"-1",cy:"-4",rx:"1",ry:"2"})]}),(0,s.jsxs)("symbol",{id:"brush-bush",viewBox:"-10 -8 20 16",stroke:"currentColor",strokeWidth:"1",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,s.jsx)("ellipse",{cx:"0",cy:"2",rx:"6",ry:"4"}),(0,s.jsx)("ellipse",{cx:"-3",cy:"0",rx:"2",ry:"1.5"}),(0,s.jsx)("ellipse",{cx:"3",cy:"0",rx:"2",ry:"1.5"})]}),(0,s.jsx)("symbol",{id:"desert-dot",viewBox:"-2 -2 4 4",stroke:"currentColor",strokeWidth:"1",fill:"none",children:(0,s.jsx)("circle",{cx:"0",cy:"0",r:"0.7"})}),(0,s.jsxs)("symbol",{id:"settlement-city",viewBox:"-10 -10 20 20",children:[(0,s.jsx)("path",{d:"M-8,-2 L-8,4 L-5,4 L-5,-2 L-6.5,-4 Z",fill:"#444",stroke:"#222",strokeWidth:"0.5"}),(0,s.jsx)("path",{d:"M5,-2 L5,4 L8,4 L8,-2 L6.5,-4 Z",fill:"#444",stroke:"#222",strokeWidth:"0.5"}),(0,s.jsx)("path",{d:"M-4,-3 L-4,5 L-1,5 L-1,-3 L-2.5,-5 Z",fill:"#333",stroke:"#222",strokeWidth:"0.5"}),(0,s.jsx)("path",{d:"M1,-3 L1,5 L4,5 L4,-3 L2.5,-5 Z",fill:"#333",stroke:"#222",strokeWidth:"0.5"}),(0,s.jsx)("path",{d:"M-2,-6 L-2,6 L2,6 L2,-6 L0,-9 Z",fill:"#222",stroke:"#222",strokeWidth:"0.5"}),(0,s.jsx)("rect",{x:"-1",y:"0",width:"0.8",height:"1",fill:"#fff"}),(0,s.jsx)("rect",{x:"0.2",y:"0",width:"0.8",height:"1",fill:"#fff"}),(0,s.jsx)("rect",{x:"-1",y:"-3",width:"0.8",height:"1",fill:"#fff"}),(0,s.jsx)("rect",{x:"0.2",y:"-3",width:"0.8",height:"1",fill:"#fff"}),(0,s.jsx)("rect",{x:"-3",y:"1",width:"0.8",height:"1",fill:"#fff"}),(0,s.jsx)("rect",{x:"2.2",y:"1",width:"0.8",height:"1",fill:"#fff"}),(0,s.jsx)("rect",{x:"-7",y:"1",width:"0.8",height:"1",fill:"#fff"}),(0,s.jsx)("rect",{x:"6.2",y:"1",width:"0.8",height:"1",fill:"#fff"})]}),(0,s.jsxs)("symbol",{id:"settlement-town",viewBox:"-10 -10 20 20",children:[(0,s.jsx)("path",{d:"M-6,-2 L-6,3 L-3,3 L-3,-2 L-4.5,-4 Z",fill:"#444",stroke:"#222",strokeWidth:"0.5"}),(0,s.jsx)("path",{d:"M3,-2 L3,3 L6,3 L6,-2 L4.5,-4 Z",fill:"#444",stroke:"#222",strokeWidth:"0.5"}),(0,s.jsx)("path",{d:"M-2,-4 L-2,4 L1,4 L1,-4 L-0.5,-6 Z",fill:"#333",stroke:"#222",strokeWidth:"0.5"}),(0,s.jsx)("path",{d:"M-1,4 L-1,6 L3,6 L3,4 L1,2 Z",fill:"#222",stroke:"#222",strokeWidth:"0.5"}),(0,s.jsx)("rect",{x:"-1",y:"0",width:"0.6",height:"0.8",fill:"#fff"}),(0,s.jsx)("rect",{x:"-5",y:"0",width:"0.6",height:"0.8",fill:"#fff"}),(0,s.jsx)("rect",{x:"4",y:"0",width:"0.6",height:"0.8",fill:"#fff"}),(0,s.jsx)("rect",{x:"0.5",y:"4.5",width:"0.6",height:"0.8",fill:"#fff"})]}),(0,s.jsxs)("symbol",{id:"settlement-village",viewBox:"-10 -10 20 20",children:[(0,s.jsx)("path",{d:"M-5,3 L-5,5 L-2,5 L-2,3 Z",fill:"#555",stroke:"none"}),(0,s.jsx)("path",{d:"M2,3 L2,5 L5,5 L5,3 Z",fill:"#555",stroke:"none"}),(0,s.jsx)("path",{d:"M-3,-1 L-3,3 L1,3 L1,-1 L-1,-3 Z",fill:"#333",stroke:"#222",strokeWidth:"0.5"}),(0,s.jsx)("path",{d:"M2,0 L2,3 L4,3 L4,0 L3,-1 Z",fill:"#222",stroke:"#222",strokeWidth:"0.5"}),(0,s.jsx)("line",{x1:"-5",y1:"5",x2:"5",y2:"5",stroke:"#222",strokeWidth:"0.3"}),(0,s.jsx)("line",{x1:"-5",y1:"5",x2:"-5",y2:"3",stroke:"#222",strokeWidth:"0.3"}),(0,s.jsx)("line",{x1:"5",y1:"5",x2:"5",y2:"3",stroke:"#222",strokeWidth:"0.3"}),(0,s.jsx)("rect",{x:"-2",y:"0.5",width:"0.6",height:"0.6",fill:"#fff"})]})]})})()}),(0,s.jsxs)("g",{clipPath:"url(#map-clip)",children:[e.filter(e=>"water"!==e.terrain).map(e=>{let t,r=b(e.q,e.r);return t=e.settlement?"#c5c5c5":h(e.terrain),(0,s.jsx)("polygon",{points:v(r),fill:t,stroke:"none",strokeWidth:"0",className:"cursor-pointer",onMouseEnter:F,onMouseLeave:I,"data-id":e.id},"terrain-".concat(e.id))}),d&&(()=>{let t=e.find(e=>e.id===d);if(!t||"water"===t.terrain)return null;let r=b(t.q,t.r);return(0,s.jsx)("polygon",{points:v(r),fill:"white",stroke:"none",strokeWidth:"0",opacity:"0.15",pointerEvents:"none"},"hover-".concat(t.id))})(),e.map(e=>{let t=b(e.q,e.r),r="water"===e.terrain;return(0,s.jsx)("g",{children:r&&!e.river&&(()=>{let r=o(e,N).filter(e=>"water"!==e.terrain);if(0===r.length)return null;let a=0,n=0;r.forEach(e=>{let r=b(e.q,e.r);a+=r.x-t.x,n+=r.y-t.y}),a/=r.length;let l=180*Math.atan2(n/=r.length,a)/Math.PI+90,i=t.x+.2*a,h=t.y+.2*n,c=["shore-wave-1","shore-wave-2","shore-wave-3","shore-wave-4"],d=0;for(let t=0;t<e.id.length;t++)d=(d<<5)-d+e.id.charCodeAt(t);let f=c[Math.abs(d)%c.length];return(0,s.jsx)("use",{href:"#".concat(f),x:i,y:h,width:.7*k,height:.35*k,transform:"rotate(".concat(l,",").concat(i,",").concat(h,")"),opacity:.4},"wave-".concat(e.id))})()},"waves-".concat(e.id))}),(()=>{var t,r;let a=e.filter(e=>"forest"===e.terrain&&!e.settlement),n=new Set,l=[];for(let e of a){if(n.has(e.id))continue;let t=[],r=[e];for(n.add(e.id);r.length;){let e=r.shift();for(let s of(t.push(e),o(e,N)))"forest"!==s.terrain||n.has(s.id)||(n.add(s.id),r.push(s))}l.push(t)}let i=[],h=q("forest",[.85,1]),d=0;function f(t,r,a){let n=e.filter(e=>e.terrain===t&&!e.settlement),l=new Set,i=[];for(let e of n){if(l.has(e.id))continue;let r=[],s=[e];for(l.add(e.id);s.length;){let e=s.shift();for(let a of(r.push(e),o(e,N)))a.terrain!==t||l.has(a.id)||(l.add(a.id),s.push(a))}i.push(r)}let h=[];return i.forEach(e=>{let n=1/0,l=-1/0,o=1/0,i=-1/0;for(let t of e){let{x:e,y:r}=b(t.q,t.r);n=Math.min(n,e),l=Math.max(l,e),o=Math.min(o,r),i=Math.max(i,r)}let d=.85*k,f=n-.5*d,x=l+.5*d,u=o-.5*d,m=i+.5*d,g=0;for(let n=f;n<=x;n+=d){for(let l=u;l<=m;l+=.9*d){let o=B("".concat(r,"-").concat(e[0].id,"-").concat(n.toFixed(1),"-").concat(l.toFixed(1))),i=(o()-.5)*k*.35,f=(o()-.5)*k*.35,x=n+i,u=l+f+(g%2==0?0:.45*d),m=null,j=1/0;for(let t of e){let{x:e,y:r}=b(t.q,t.r),s=(x-e)**2+(u-r)**2;s<j&&(m=t,j=s)}if(m&&j<(.95*k)**2){let[i,d]=a,f=k*(i+o()*(d-i)),m="";switch(r){case"hill-arch":case"swamp-marsh":m="translate(".concat(-f/2,",").concat(-(.3*f),")");break;case"mountain-peak":m="translate(".concat(-f/2,",").concat(-(.6*f),")");break;case"forest-evergreen":case"forest-broadleaf":m="translate(".concat(-f/2,",").concat(-(.7*f),")");break;case"brush-bush":m="translate(".concat(-f/2,",").concat(-(.4*f),")");break;case"grass-tuft":case"desert-rock1":case"desert-rock2":case"desert-rock3":m="translate(".concat(-f/2,",").concat(-(.2*f),")");break;case"desert-dot":m="translate(".concat(-f/2,",").concat(-(.1*f),")");break;default:m="translate(".concat(-f/2,",").concat(-(.5*f),")")}let g=c(t);h.push((0,s.jsx)("g",{style:{color:g},children:(0,s.jsx)("use",{href:"#".concat(r),x:x,y:u,width:f,height:f,transform:m,stroke:g,fill:"none"})},"".concat(r,"-").concat(e[0].id,"-").concat(n,",").concat(l)))}}g++}}),h}h.forEach(e=>{let t=.5>B("tree-".concat(e.clusterIdx,"-").concat(e.gridX,"-").concat(e.gridY))()?"forest-evergreen":"forest-broadleaf",r=c("forest");i.push((0,s.jsx)("g",{style:{color:r},children:(0,s.jsx)("use",{href:"#".concat(t),x:e.x,y:e.y,width:e.size,height:e.size,transform:"translate(".concat(-e.size/2,",").concat(-(.8*e.size),")"),stroke:r,fill:"none"})},"tree-".concat(e.clusterIdx,"-").concat(e.gridX,"-").concat(e.gridY,"-").concat(d++)))});let x=f("mountain","mountain-peak",[.8,1.1]),u=f("hills","hill-arch",[.7,1]),m=f(t="grassland",r="grass-tuft",[.7,1]).filter((e,s)=>B("filter-".concat(t,"-").concat(r,"-").concat(s))()>.6),g=function(){let t=q("desert",[.4,.6]),r=["desert-rock1","desert-rock2","desert-rock3"],a=c("desert");return e.filter(e=>"desert"===e.terrain),t.map((e,t)=>{let n=B("desert-dot-".concat(t,"-").concat(e.x.toFixed(1),"-").concat(e.y.toFixed(1)));if(.8>n())return(0,s.jsx)("g",{style:{color:a},children:(0,s.jsx)("use",{href:"#desert-dot",x:e.x,y:e.y,width:4,height:4,transform:"translate(-2,-2)",stroke:a,fill:"none"})},t);{let l=r[Math.floor(n()*r.length)];return(0,s.jsx)("g",{style:{color:a},children:(0,s.jsx)("use",{href:"#".concat(l),x:e.x,y:e.y,width:8,height:8,transform:"translate(-4,-4)",stroke:a,fill:"none"})},t)}})}();return[...i,...x,...u,...m,...g,...f("swamp","brush-bush",[.7,1]),...f("brush","swamp-marsh",[.7,1])]})(),e.map(e=>{let t,r;if(!e.settlement)return null;let a=b(e.q,e.r);switch(e.settlement){case"city":t="settlement-city",r=1.8*k;break;case"town":t="settlement-town",r=1.5*k;break;default:t="settlement-village",r=1.3*k}return(0,s.jsx)("g",{transform:"translate(".concat(a.x,",").concat(a.y,") scale(1,0.85)"),children:(0,s.jsx)("use",{href:"#".concat(t),x:-r/2,y:-r/2,width:r,height:r})},"settlement-".concat(e.id))}),(()=>{let e=Math.ceil(.18*x),t=Math.ceil(.45*m),r=!1,s=null;for(let a of["left","right"]){for(let n=t;n>=2;n--){for(let t=e;t>=2;t--){for(let e=0;e<=m-n;e++){let l="left"===a?0:x-t;if(function(e,t,r,s){for(let a=e;a<e+r;a++)for(let e=t;e<t+s;e++){let t=N["".concat(a,",").concat(e)];if(!t||"water"!==t.terrain)return!1}return!0}(l,e,t,n)){s={q0:l,r0:e,w:t,h:n,side:a},r=!0;break}}if(r)break}if(r)break}if(r)break}return s||(s={q0:0,r0:m-t,w:e,h:t,side:"left"}),null})(),p.map((e,t)=>(0,s.jsx)("path",{d:function(e){if(e.length<2)return"";let t="M".concat(e[0].x,",").concat(e[0].y);for(let r=0;r<e.length-1;r++){let s=e[r-1]||e[r],a=e[r],n=e[r+1],l=e[r+2]||n,o=a.x+(n.x-s.x)/6,i=a.y+(n.y-s.y)/6,h=n.x-(l.x-a.x)/6,c=n.y-(l.y-a.y)/6;t+=" C".concat(o,",").concat(i," ").concat(h,",").concat(c," ").concat(n.x,",").concat(n.y)}return t}(e),fill:"none",stroke:"#333",strokeWidth:.13*k,strokeDasharray:"".concat(.28*k,",").concat(.18*k),strokeLinecap:"round",strokeLinejoin:"round",opacity:.65},"road-path-".concat(t)))]})]})})}),(0,s.jsx)("div",{className:"fixed bottom-4 left-1/2 transform -translate-x-1/2 w-[95vw] max-w-sm sm:w-auto sm:max-w-none sm:left-auto sm:right-4 sm:translate-x-0 bg-white rounded-lg shadow-lg border border-gray-300 p-3 z-10",children:(0,s.jsx)("div",{className:"grid grid-cols-3 gap-x-4 gap-y-1 text-xs whitespace-nowrap",children:Array.from({length:4}).map((e,t)=>(0,s.jsxs)(a.Fragment,{children:[(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)("div",{className:"w-3 h-3 rounded border border-gray-300 flex-shrink-0",style:{backgroundColor:h(Object.values(n)[t])}}),"water"!==Object.values(n)[t]&&(0,s.jsx)("svg",{className:"w-3 h-3 flex-shrink-0",viewBox:"-10 -10 20 20",children:(()=>{let e=Object.values(n)[t];return"forest"===e?(0,s.jsx)("g",{style:{color:c("forest")},children:(0,s.jsx)("use",{href:"#forest-evergreen",width:"20",height:"20",transform:"translate(-10,-10)",stroke:c("forest"),strokeWidth:"3"})}):"mountain"===e?(0,s.jsx)("g",{style:{color:c("mountain")},children:(0,s.jsx)("use",{href:"#mountain-peak",width:"20",height:"20",transform:"translate(-10,-10)",stroke:c("mountain"),strokeWidth:"3"})}):"hills"===e?(0,s.jsx)("g",{style:{color:c("hills")},children:(0,s.jsx)("use",{href:"#hill-arch",width:"20",height:"20",transform:"translate(-10,-10)",stroke:c("hills"),strokeWidth:"3"})}):"grassland"===e?(0,s.jsx)("g",{style:{color:c("grassland")},children:(0,s.jsx)("use",{href:"#grass-tuft",width:"20",height:"20",transform:"translate(-10,-10)",stroke:c("grassland"),strokeWidth:"2"})}):"desert"===e?(0,s.jsxs)("g",{style:{color:c("desert")},children:[(0,s.jsx)("use",{href:"#desert-dot",width:"6",height:"6",transform:"translate(-3,-3)",stroke:c("desert"),strokeWidth:"2"}),(0,s.jsx)("use",{href:"#desert-rock1",width:"10",height:"10",transform:"translate(2,-5)",stroke:c("desert"),strokeWidth:"2"})]}):"swamp"===e?(0,s.jsx)("g",{style:{color:c("swamp")},children:(0,s.jsx)("use",{href:"#brush-bush",width:"20",height:"20",transform:"translate(-10,-10)",stroke:c("swamp"),strokeWidth:"2"})}):"brush"===e?(0,s.jsx)("g",{style:{color:c("brush")},children:(0,s.jsx)("use",{href:"#swamp-marsh",width:"20",height:"20",transform:"translate(-10,-10)",stroke:c("brush"),strokeWidth:"2"})}):null})()}),(0,s.jsx)("span",{className:"capitalize text-gray-700 text-xs truncate",children:Object.values(n)[t]})]}),(0,s.jsx)("div",{className:"flex items-center gap-1",children:Object.values(n)[t+4]&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"w-3 h-3 rounded border border-gray-300 flex-shrink-0",style:{backgroundColor:h(Object.values(n)[t+4])}}),"water"!==Object.values(n)[t+4]&&(0,s.jsx)("svg",{className:"w-3 h-3 flex-shrink-0",viewBox:"-10 -10 20 20",children:(()=>{let e=Object.values(n)[t+4];return"forest"===e?(0,s.jsx)("g",{style:{color:c("forest")},children:(0,s.jsx)("use",{href:"#forest-evergreen",width:"20",height:"20",transform:"translate(-10,-10)",stroke:c("forest"),strokeWidth:"3"})}):"mountain"===e?(0,s.jsx)("g",{style:{color:c("mountain")},children:(0,s.jsx)("use",{href:"#mountain-peak",width:"20",height:"20",transform:"translate(-10,-10)",stroke:c("mountain"),strokeWidth:"3"})}):"hills"===e?(0,s.jsx)("g",{style:{color:c("hills")},children:(0,s.jsx)("use",{href:"#hill-arch",width:"20",height:"20",transform:"translate(-10,-10)",stroke:c("hills"),strokeWidth:"3"})}):"grassland"===e?(0,s.jsx)("g",{style:{color:c("grassland")},children:(0,s.jsx)("use",{href:"#grass-tuft",width:"20",height:"20",transform:"translate(-10,-10)",stroke:c("grassland"),strokeWidth:"2"})}):"desert"===e?(0,s.jsxs)("g",{style:{color:c("desert")},children:[(0,s.jsx)("use",{href:"#desert-dot",width:"6",height:"6",transform:"translate(-3,-3)",stroke:c("desert"),strokeWidth:"2"}),(0,s.jsx)("use",{href:"#desert-rock1",width:"10",height:"10",transform:"translate(2,-5)",stroke:c("desert"),strokeWidth:"2"})]}):"swamp"===e?(0,s.jsx)("g",{style:{color:c("swamp")},children:(0,s.jsx)("use",{href:"#brush-bush",width:"20",height:"20",transform:"translate(-10,-10)",stroke:c("swamp"),strokeWidth:"2"})}):"brush"===e?(0,s.jsx)("g",{style:{color:c("brush")},children:(0,s.jsx)("use",{href:"#swamp-marsh",width:"20",height:"20",transform:"translate(-10,-10)",stroke:c("brush"),strokeWidth:"2"})}):null})()}),(0,s.jsx)("span",{className:"capitalize text-gray-700 text-xs truncate",children:Object.values(n)[t+4]})]})}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[0===t&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("svg",{className:"w-5 h-3 flex-shrink-0",viewBox:"0 0 24 8",style:{verticalAlign:"middle"},children:(0,s.jsx)("path",{d:"M2 6 Q8 2 14 6 Q20 10 22 2",stroke:"#333",strokeWidth:"2",fill:"none",strokeDasharray:"6,4",strokeLinecap:"round"})}),(0,s.jsx)("span",{className:"text-gray-700 text-xs truncate",children:"Roads"})]}),1===t&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("svg",{className:"w-4 h-4",viewBox:"-10 -10 20 20",children:(0,s.jsx)("use",{href:"#settlement-city"})}),(0,s.jsx)("span",{className:"text-gray-700 text-xs",children:"City"})]}),2===t&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("svg",{className:"w-4 h-4",viewBox:"-10 -10 20 20",children:(0,s.jsx)("use",{href:"#settlement-town"})}),(0,s.jsx)("span",{className:"text-gray-700 text-xs",children:"Town"})]}),3===t&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("svg",{className:"w-4 h-4",viewBox:"-10 -10 20 20",children:(0,s.jsx)("use",{href:"#settlement-village"})}),(0,s.jsx)("span",{className:"text-gray-700 text-xs",children:"Village"})]})]})]},t))})})]})}},7224:(e,t,r)=>{Promise.resolve().then(r.bind(r,527))}},e=>{var t=t=>e(e.s=t);e.O(0,[441,684,358],()=>t(7224)),_N_E=e.O()}]);